ASM
PUSH 0xA ; 1010

:::__LBL_WAIT_SPI_TXE
BTJF (SPI_SR), SPI_SR_TXE_POS, ::__LBL_WAIT_SPI_TXE

:::__LBL_TR_LOOP
RLWA Y

LD (SPI_DR), A
:::__LBL_WAIT_SPI_RXNE
BTJF (SPI_SR), SPI_SR_RXNE_POS, ::__LBL_WAIT_SPI_RXNE
LD A, (SPI_DR)

SRL (1, SP)
JRNC ::__LBL_TR_LOOP
EXGW X, Y
RLWA X
TNZ (1, SP)

JRNE ::__LBL_TR_LOOP

POP A
ENDASM
