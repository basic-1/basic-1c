INI,__LIB_USART_OPT

; stop USART
:__LIB_USART_7_CALL
ASM
; do not wait for data transmission complete if TX is disabled
BTJF (__LIB_USART_OPT), 3, ::__LBL_UART_STOP

:::__LBL_TST_WAIT_TC
BTJF (USART_SR), USART_SR_TC_POS, ::__LBL_TST_WAIT_TC

:::__LBL_UART_STOP
; disable RX/TX
CLR (USART_CR2)
RET
ENDASM