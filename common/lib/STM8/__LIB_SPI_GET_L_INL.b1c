ASM
PUSH 0xA ; 1010

:::__LBL_WAIT_SPI_RXNE
BTJF (SPI_SR), SPI_SR_RXNE_POS, ::__LBL_WAIT_SPI_RXNE
LD A, (SPI_DR)

RLWA Y
SRL (1, SP)
JRNC ::__LBL_NO_EXG_XY
EXGW X, Y

:::__LBL_NO_EXG_XY
JRNE ::__LBL_WAIT_SPI_RXNE

POP A
ENDASM